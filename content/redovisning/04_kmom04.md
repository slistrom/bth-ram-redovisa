---
---
Redovisning kmom04
=========================

## Hur gick arbetet med att lyfta ut koden ur redovisa-sidan och placera i en egen modul, några svårigheter, utmaningar eller annat värt att nämna?
Det gick relativt smidigt får jag säga. Det var lite klurigt att lista ut vad jag behövde flytta ut. Första delen att flytta mina egna filer var ju rätt självklart men sen vilka fler filer jag behövde tog ett tag att förstå. Var intressant att få en bättre bild av vad som behövs för att t.ex. en modul skall "stå på egna ben". I det här läget var det ju mycket som jag kunde återanvända från tidigare kod och filer när jag väl listat ut vad som behövdes.

## Gick det bra att publicera på Packagist och ta emot uppdateringar från GitHub?
Tyckte det var väldigt smidigt att publicera på Packagist eftersom det verkar så integrerat med Github. Tog någon minut att koppla så att packagist uppdaterades automatiskt men även det gick relativt smidigt. 

## Fungerade det smidigt att åter installera modulen i din redovisa-sida med composer, kunde du följa din egen installationsmanual?
Det gick även smidigt att installera modulen i min redovisa sida. Det var kul att lära mig mer om composer i detta kursmoment. Jag har ju använt det i tidigare kurser och förstått att det är lite som npm, men det var först i detta kursmoment som jag tittade lite mer på det och började förstå hur det fungerar. Gillar verkligen sättet som både composer och npm fungerar. Smidigt att ha ett verktyg som hjälper till att hämta med kod som man vill använda som andra har skrivit och som hjälper till att hålla koll på versioner och annat. 

Först när jag testade att installera min modul så gjorde jag det i min test Anax som jag kopierade in i min moduls "utvecklingsmiljö". När jag gjorde det och testade runt lite så hade jag först inte förstått vad som behövdes kopiera över från modulen till anax. Nu är det lite klarare och jag förstår hur autoloadern använder även de klasser i /vendor katalogen, dvs att jag inte behövde flytta över mina klassfiler in till Anax från modulen utan primärt config filerna och vyer. Det är ju även nice att så mycket filer som möjligt ligger kvar i modulen så att de "uppdateras automatiskt" när man gör en composer update. Trots det så valde jag att denna gång även flytta över mina filer i src/ och tester till min me/redovisa för att kunna köra tester i fortsättningen även för mitt me/redovisa repo. Men det är kul att veta att jag inte hade behövt det egentligen. 

## Hur väl lyckas du enhetstesta din modul och hur mycket kodtäckning fick du med?
Det var här som det började krångla till det. Jag kunde installera och testa min modul i både min moduls egna Anax och i min me/redovisa, jag fick dock inte till själva testningen i den separate modulen. Det tog ett tag innan jag förstod hur jag skulle få de tjänster som jag integrerat med Anax att fungera i min modul utan att ha ett Anax initierat. Efter att ha tittat på labvideon, slängt ute lite frågor i Discord och pratat med lite medstudenter så började jag förstå. Kan inte påstå att jag helt förstår men jag lyckades iallafall simulera Anax DI tjänsterna så att mina tester i modulen skulle gå igenom.

Jag är väldigt nöjd med min enhetstester. I oophp lyckades jag testa det mesta men det var mest tester av typen på returnerade objekt och inte så många asserts där jag testade vad som faktiskt returneras. I denna kura lyckades jag förstå bättre hur testningen fungerar och har lyckats skriva tester som faktiskt testar att min kod returnerar inte bara rätt typ av objekt utan också vettig data. I de första kursmomenten lyckades jag därför uppnå i princip 100% kodtäckning som även var vettig i min mening. Sen när vi började med externa kopplingar till andra tjänster så blev det ju lite mer komplicerat att upprätthålla möjligheten för andra personer (lärare) att testa utan tillgång till API nyckel och det blev ännu en komplexitetsnivå när vi började lära oss att göra tester som inte ens frågade de externa tjänsterna alls, dvs att skriva Mock klasser. Jag lyckades skriva Mock klasser till alla mina klasser och jag tror nu att både min me/redovisa och min modul går att testa helt oberoende av de externa tjänsterna vilket känns rätt häftigt. Dock eftersom mina klasser mest består av just funktioner som har någon relation till de externa tjänsterna så sjönk min kodtäckning väsentligt när jag började använda mina mockade klasser. Från att ha nästan 100% kodtäckning har jag nu mellan 50-60%. Det känns ju bra att jag inte har några externa beroenden i min testning men tråkigt att kodtäckningen sjönk så mycket. Samtidigt som jag vet att jag skulle kunna titta mer på att bryta ut de externa anropen till separata klasser för att öka kodtäckningen, det beslutade jag dock ligga lite utanför min ambitionsnivå just denna gång.

## Några reflektioner över skillnaden med och utan modul?
När jag bröt ut min kod från Anax till en egen modul funderade jag en del på att använda ett ramverk egentligen går lite emot SOLID, då tänker jag mest på att man ju skapar ett beroende mellan sin egen kod och ramverket. Nu är ju det kanske svårt att undgå och oftast om man väljer ett ramverk tänker jag att man gör det för att man får så många andra fördelar. Men vore det inte härligt om ramverken i sig var gjorda på ett sätt så att folk som använder dem inte blev beroende av dem? Kanske en omöjlighet i sättet vi tänker runt ett ramverk i dagsläget men ändå intressant tanke tycker jag.

Sedan är det ju rätt häftigt att kunna modularisera en del av sin kod så att i teorin andra skulle kunna använda den i relation till Anax i det här fallet och relativt enkelt installera den via composer. Känns fint när allt hänger ihop. Sedan behöver jag nog en hel del mer kunskap om hur moduler till ramverk fungerar för att få dem ännu mer oberende. Känns som om min modul ändå har en hel del grejer som användaren som potentiellt skulle använda den behöver göra för att få det att fungera "på riktigt".

## Vilket ramverk undersökte du och hur hanterar det ramverket paketering, moduler och versionshantering?
Jag undersökte Laravel men inser att jag har en del kvar att lära mig tills jag faltiskt förstår vad det är som händer och hur strukturen i de olika ramverk jag undersöker faktiskt fungerar. Det sagt så kändes det lite roligt att kunna ens veta vart jag skulle leta och förstå vad det är som händer när t.ex. Laravel gör require på olika saker i ders composer.json som ligger på Github. Om jag förstog rätt så kallar Laravel det vi kallat för modul i detta kursmoment för ett paket. Det verkar ju som att Laravel även använder Composer för att hantera sina beroenden och pakethantering. När man har egna paket som man sedan vill integrera med Laravel så har Laravel hjälpfunktioner för att ladda in resurserna i ramverket. Lite som att vi använder rsync i detta kursmoment har de funktioner som hjälper till att få in vissa typer av filer på rätt plats, typ vyer eller routes. 

## Vilken är din TIL för detta kmom?
Dels lärde jag mig mycket mer om Composer och Packagist var helt nytt för mig, både trevligt nya kunskaper.

Sedan har jag funderat mycket på varför jag blir så frustrerad när jag jobbar med Anax. I grunden kommer ju fristrationen utan av min egen imkompetens där jag blir frustrerad när jag inte förstår och kan lösa en viss uppgift. Jag hade en något liknande känsla när jag jobbade med React i jsramverkskursen och baserat på det pyttelilla jag nu näst om Laravel och Symfony skulle jag säkert stöta på liknande situationer där. Det får mig att tänka tillbaka på något jag reflekterade över innan där jag upplever att dokumentation oftast är skriven för de som redan förstått en vissa sak och det är guider som hjälper nya personer att förstå. Både Anax och andra ramverk upplever jag väldokumenterade, men det hjälper sällan mig som ny användare. Oftast pga att dokumentationen utgår från ett "greenfield" läge som jag som användare väldigt sällan befinner mig i, utan jag har en salig röra av saker i kombination med t.ex. ramverket som strular och ställer till det. Både Anax och andra ramverk har en del guider men även de utgår oftast från en väldigt basal nivå där de inte riktigt täcker in just det exempel som jag själv sitter och har problem med. Den stora skillnanden mellan Anax och andra ramverk är den stora externa community som fastnar på samma saker som jag gör och frågar om hjälp och får lösningar som jag kan använda mig av "ute på Internet". Å andra sidan så har ju Anax ett fantastiskt community i form av lärare och studenter som kan hjälpa mig, så det kanske går ett ut.

Men grundutmaningen tycker jag verkar finnas kvar oavsätt vilket ramverk jag skulle använda, dvs att jag måste förstå ramverket innan jag får någon nytta av det och när jag väl förstår ramverket så behöver jag till stor del anpassa mig till ramverket och även då bli beroende av ramverket. Nu med "smarta" IDEer och väl använd kodkommentering så kan man ju få lite tips om hur saker skall skrivas. Men jag skulle tycka det var häftigt ifall ramverken var designade som en guide där ramverket i sig hjälper en ny person att förstå hur det fungerar och att det finns stöd i ramverket för att hjälpa personer både skriva kod inom ramverket men även skriva kod utan att skapa beroenden till ramverket. Kanske får ta och uppfinna ett sådant designmönster själv helt enkelt :)